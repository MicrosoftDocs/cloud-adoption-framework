Once your modernized solution passes all tests in the nonproduction environment, you should capture the infrastructure setup and configurations as code, so it can be easily replicated in production and future environments. Reusable infrastructure means using infrastructure-as-code (IaC) templates and automation for consistency and speed.

1. **Create IaC templates for proven configurations.** Take the final architecture of your test environment (which mirrors what you want in prod) and codify it. Use [Bicep](/azure/azure-resource-manager/bicep/overview), [Terraform](/azure/developer/terraform/overview), or [Azure Resource Manager templates](/azure/azure-resource-manager/templates/overview) to define your infrastructure. Parameterize these templates so they can be reused for different stages (dev/test/prod with small tweaks like names or sizes). This setup ensures that the production environment you create matches what you tested (no human error in manually clicking around Azure portal to create resources). It also means if you ever need to recreate the environment (disaster recovery, scaling out regions), you have the blueprint ready. For more information, see [CAF Manage - Manage code-based deployments](/azure/cloud-adoption-framework/manage/administer#manage-code-deployments).

2. **Store templates in version control.**  Check your infrastructure code into a Git repository (e.g., alongside the application code or in a separate repo). Use [GitHub](https://docs.github.com/repositories) or [Azure DevOps](/azure/devops/repos/get-started/) to manage IaC assets with proper version control. Version control enables code reviews, supports team collaboration, and encourages template reuse across projects. This approach provides complete traceability for infrastructure changes and supports rollback capabilities when issues occur.

3. **Automate dependency installation and configuration.** Create scripts or pipeline tasks to deploy these templates and also handle any required configuration or seeding tasks. Use [Azure Pipelines](/azure/devops/pipelines/), [GitHub Actions](https://docs.github.com/actions)to run deployment jobs that take the IaC template and deploy to a target subscription/resource group.
Automate installing app dependencies, configuring settings, and [secrets management](/azure/key-vault/general/basic-concepts). The goal is one-click (or one-command) environment setup: from nothing to a fully running environment that matches what you tested.

4. **Test the IaC and automation end-to-end.** Use a separate Azure subscription or resource group as a sandbox and practice deploying your entire environment from scratch using your templates and scripts. Test that your IaC templates, pipelines, and scripts can create the complete infrastructure stack from nothing. Test different deployment scenarios including initial deployment, configuration updates, and rollback procedures to confirm the automation works correctly.

For more information, see [Design a workload development supply change](/azure/well-architected/operational-excellence/workload-supply-chain) and [Infrastructure as code](/azure/well-architected/operational-excellence/infrastructure-as-code-design) in WAF.
